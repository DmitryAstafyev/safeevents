"use strict";var SafeEvents=function(){};SafeEvents.prototype={onloop:"onloop",_divider:"_$$_",_before:"SafeEvents___$",_after:"$___",__prefix:/SafeEvents___\$(.*?)\$___/gi,__clear:/SafeEvents___\$|\$___/gi,_events:{},bind:function(n,t){this._events[n]=this._events[n]||[];this._events[n].push(t)},unbind:function(n,t){this._events[n]!==void 0&&~this._events[n].indexOf(t)&&this._events[n].splice(this._events[n].indexOf(t),1)},trigger:function(n){var t=this.chain(),f=Array.prototype.slice.call(arguments,1),i=this,r=null,u=null;if(~t.indexOf(n)){if(r="Event ["+n+"] called itself. Full chain: "+t.join(", "),this._events[this.onloop]!==void 0){try{throw new Error(r);}catch(e){u=e.stack}return this._events[this.onloop].forEach(function(f){f.call(i,r,t,n,u)}),!1}throw new Error(r);}this._events=this._events||{};this._events[n]!==void 0&&(t.push(n),this._events[n].forEach(function(n){setTimeout(function(n,t,r){return function(){var u=new Function("return (function(){ return function "+i._before+n.join(i._divider)+i._after+"(callback){ callback(); };}());")();u(function(){t.apply(i,r)})}}(t,n,f),1)}))},chain:function(){var n=null;try{throw new Error("Stack checking");}catch(t){n=t.stack.match(this.__prefix);n instanceof Array&&n.length===1?(n=n[0].replace(this.__clear,""),n=n!==""?n.split(this._divider):[]):n=[]}return n},safely:function(n){var t=this.chain();return t!==null?new Function("return function(callback){ return function "+this._before+t.join(this._divider)+this._after+"(){ return callback.apply(this, arguments);};};")()(n):n}};SafeEvents.inherit=function(n){var i=typeof n=="function"?n.prototype:typeof n=="object"?n:null,t;if(i!==null){for(t in SafeEvents.prototype)t!=="inherit"&&(i[t]=SafeEvents.prototype[t]);i._events={}}};typeof module!="undefined"&&module.exports!==void 0&&(module.exports=SafeEvents);